const utils=require("../utils/utils"),unsupportedFns=require("./unsupported-fns"),unsupportedTags=require("./unsupported-tags"),unsupportedAttrs=require("./unsupported-attrs"),wxmlLineRules=[e=>{const s="组件百度小程序未实现";for(let r=0;r<unsupportedTags.length;r++){const u=unsupportedTags[r],t=new RegExp(`<${u}\\s+`);if(e.match(t))return{source:e,rule:[u,s].join("")}}return null},e=>{const s=/[^<>(?:]+/,r=e.match(/bind\w+\s*=\s*['"]([^'"]+)['"]/);return r&&!s.test(r[1])?{source:r[0],rule:"bind*={{str}}  `str`只能是函数名（字符串），不能包含函数计算（如：`bindtap=\"flag ? 'fn1' : 'fn2'\"`）"}:null},e=>{const s=/[^<>(?:]+/,r=e.match(/wx:for=['"](.+)['"]/);return r&&!s.test(r[1])?{source:e,rule:"wx:for={{arr}}  `arr`不能包含达式计算（如：`wx:for='{{flag ? arr1 : arr2}}'`）"}:null},e=>{return e.match(/\s+hidden=["'].+['"]/)?{source:e,rule:"wxml不支持`hidden`"}:null}],wxmlFileRules=[(e,s)=>{const r=[];return e.replace(/<[^>]+wx:for=[^>]+wx:if=['"](.+)['"][^>]*>/g,u=>{const t=utils.calcLine(e,u);r.push({path:s,line:t,source:u,rule:"在同一个标签上，`wx:for`和`wx:if`不能同时使用"})}),r},(e,s)=>{const r=[];return unsupportedAttrs.forEach(u=>{u.attrs.forEach(t=>{const l=new RegExp(`<${u}[^>]+${t}=`),n=e.match(l);if(n){const l=utils.calcLine(e,n),i=`百度小程序 ${u.tag} 组件不支持 ${t} 属性`;r.push({path:s,line:l,source:n,rule:i})}})}),r}],wxssLineRules=[],wxssFileRules=[],scriptFileRules=[],scriptLineRules=[e=>{const s="方法百度小程序未实现";for(let r=0;r<unsupportedFns.length;r++){const u=unsupportedFns[r],t=new RegExp(`\\.${u}\\(`);if(e.match(t))return{source:e,rule:[u,s].join("")}}return null}];module.exports={wxmlFileRules:wxmlFileRules,wxmlLineRules:wxmlLineRules,wxssFileRules:wxssFileRules,wxssLineRules:wxssLineRules,scriptFileRules:scriptFileRules,scriptLineRules:scriptLineRules};