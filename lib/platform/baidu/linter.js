const utils=require("../../utils/utils"),commonLint=require("../../utils/linter"),wxmlLineRules=[r=>{const l=/^\w+$/,e=r.match(/bind\w+\s*=\s*['"]([^'"]+)['"]/);return e&&!l.test(e[1])?{source:e[0],rule:"bind*={{str}}  `str`只能是函数名（字符串），不能包含函数计算（如：`bindtap=\"flag ? 'fn1' : 'fn2'\"`）"}:null},r=>{const l=/{{\s*\w+\s*}}/,e=r.match(/wx:for=['"](.+)['"]/);return e&&!l.test(e[1])?{source:r,rule:"wx:for={{arr}}  `arr`不能包含达式计算（如：`wx:for='{{flag ? arr1 : arr2}}'`）"}:null},r=>{return r.match(/\s+hidden=["'].+['"]/)?{source:r,rule:"wxml不支持`hidden`"}:null}],wxmlFileRules=[(r,l)=>{const e=[];return r.replace(/<[^>]+wx:for=[^>]+wx:if=['"](.+)['"][^>]*>/g,t=>{let n=utils.calcLine(r,t);e.push({path:l,line:n,source:t,rule:"在同一个标签上，`wx:for`和`wx:if`不能同时使用"})}),e}];function lint(r="./src"){commonLint(r+"/**/*.wxml",wxmlFileRules,wxmlLineRules)}module.exports=lint;