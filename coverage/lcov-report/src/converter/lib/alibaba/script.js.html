<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/converter/lib/alibaba/script.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../index.html">All files</a> / <a href="index.html">src/converter/lib/alibaba</a> script.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">24.49% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>12/49</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">3.85% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>1/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">43.75% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>7/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>1/1</span>
      </div>
    </div>
    <p class="quiet">
      Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
    </p>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">2x</span></td><td class="text"><pre class="prettyprint lang-js">const uneval=require("uneval"),balancingGroup=require("../utils/balancing-group"),extractFn=require("../utils/extra-function");function defQuery(e,t){return[e,`${t} = ${t} || {}; ${t}.query = ${t}.query || {};`].join("")}function convert(jsText,isWpy){return jsText.replace(/(require\(['"])(\w+)/g,"$1./$2").replace(/(from\s+['"])(\w+)/g,<span class="fstat-no" title="function not covered" >(e</span>,t)=&gt;<span class="cstat-no" title="statement not covered" >e.replace(t,[t,isWpy?"":"./"].join("")))</span>.replace(/(let|var|const)\s+fetch\s*=/g,"$1 renameFetch = ").replace(/(\s+)fetch([;\s]*)$/,"$1renameFetch$2").replace(/[^\w.'"]fetch[.(]/g,e=&gt;e.replace(/fetch/g,"renameFetch")).replace(/App\({[\s\S]+(onLaunch|onShow):\s*function\s*\(\s*(\w+)\s*\)[^{]*{/g,<span class="fstat-no" title="function not covered" >(e</span>,t,r)=&gt;<span class="cstat-no" title="statement not covered" >defQuery(e,r))</span>.replace(/App\({[\s\S]+(onLaunch|onShow)\s*\(\s*(\w+)\s*\)[^{]*{/g,(e,t,r)=&gt;defQuery(e,r)).replace(/App\({[\s\S]+(onLaunch|onShow):\s*\(\s*(\w+)\s*\)\s*=&gt;\s*[^{]*{/g,<span class="fstat-no" title="function not covered" >(e</span>,t,r)=&gt;<span class="cstat-no" title="statement not covered" >defQuery(e,r))</span>.replace(/Component\([\s\S]+properties:[^{]*{/,<span class="fstat-no" title="function not covered" >e=</span>&gt;<span class="cstat-no" title="statement not covered" >e.replace("properties","props"))</span>.replace(/\.properties/g,e=&gt;e.replace(".properties",".props")).replace(/Component\([\s\S]+methods:[^{]*{/,<span class="fstat-no" title="function not covered" >e=</span>&gt;<span class="cstat-no" title="statement not covered" >[e,",\r\ntriggerEvent: function(name, opt) {\n            this.props['on' + name[0].toUpperCase() + name.substring(1)]({detail:opt});\n          },\r\n"].join(""))</span>.replace(/[\s\S]+/,match=&gt;{<span class="missing-if-branch" title="else path not taken" >E</span>if(!match.match(/Component\(/))return match;const lifeCircleNames=<span class="cstat-no" title="statement not covered" >["created","attached","ready","detached"],</span>lifeCircleFns=<span class="cstat-no" title="statement not covered" >lifeCircleNames.map(<span class="fstat-no" title="function not covered" >e=</span>&gt;{const{args:t,body:r}=<span class="cstat-no" title="statement not covered" >extractFn(match,e);<span class="cstat-no" title="statement not covered" ></span>return`${e}(${t})${r||"{}"}`}</span>).join(",\n"),</span>methods=<span class="cstat-no" title="statement not covered" >(match.match(/methods:[\s\n]*{/)||{})[0];<span class="cstat-no" title="statement not covered" ></span>match=methods?match.replace(methods,[methods,lifeCircleFns].join("\r\n")):match.replace("Component({",["Component({","methods: {",lifeCircleFns,"}"].join("\r\n"));c</span>onst props=<span class="cstat-no" title="statement not covered" >(match.match(/props:[\s\S]+/)||{})[0]||"";<span class="cstat-no" title="statement not covered" ></span>if(!props)<span class="cstat-no" title="statement not covered" >return match;c</span></span>onst str=<span class="cstat-no" title="statement not covered" >balancingGroup(props),</span>obj=<span class="cstat-no" title="statement not covered" >eval(`(${str})`),</span>has=<span class="cstat-no" title="statement not covered" >Object.prototype.hasOwnProperty,</span>propMap=<span class="cstat-no" title="statement not covered" >{};</span>let observerMap=<span class="cstat-no" title="statement not covered" >null;</span>const events=<span class="cstat-no" title="statement not covered" >match.match(/\.triggerEvent\(['"]\w+['"]/g)||[];<span class="cstat-no" title="statement not covered" ></span>for(let e=<span class="cstat-no" title="statement not covered" >0;</span>e&lt;events.length;e++){const t=<span class="cstat-no" title="statement not covered" >events[e];</span>let r=<span class="cstat-no" title="statement not covered" >t.match(/\(['"](\w+)['"]/)[1];<span class="cstat-no" title="statement not covered" ></span>r=`on${r[0].toUpperCase()}${r.substring(1)}`,propMap[r]=(<span class="fstat-no" title="function not covered" >()</span>=&gt;{})}<span class="cstat-no" title="statement not covered" ></span>O</span>bject.keys(obj).forEach(<span class="fstat-no" title="function not covered" >ke</span>y=&gt;{<span class="cstat-no" title="statement not covered" >if(has.call(obj,key)){const item=<span class="cstat-no" title="statement not covered" >obj[key];<span class="cstat-no" title="statement not covered" ></span>propMap[key]=item.value,item.observer&amp;&amp;(observerMap=observerMap||{},"function"==typeof item.observer?observerMap[key]=item.observer:observerMap[key]=eval(`() =&gt; {\n                  this["${item.observer}"].apply(this, arguments);\n                }`))}</span>}</span>);c</span>onst didMount=<span class="cstat-no" title="statement not covered" >"\n        didMount() {\n          this.data = Object.assign({}, this.data, this.props);\n          \n          this.created &amp;&amp; this.created.apply(this, arguments);\n          this.attached &amp;&amp; this.attached.apply(this, arguments);\n          this.ready &amp;&amp; this.ready.apply(this, arguments);\n        }",</span>didUnmount=<span class="cstat-no" title="statement not covered" >",\n        didUnmount() {\n          this.detached &amp;&amp; this.detached.apply(this, arguments);\n        }",</span>didUpdate=<span class="cstat-no" title="statement not covered" >",\n          didUpdate: function(prevProps, preData) {\n            for (let key in this.props) {\n              if (_observers &amp;&amp; typeof(_observers[key]) === 'function') {\n                if (JSON.stringify(prevProps[key]) !== JSON.stringify(this.props[key]) &amp;&amp; \n                JSON.stringify(preData[key]) !== JSON.stringify(this.props[key])) {\n                  this.setData(Object.assign({}, this.data, {[key]: this.props[key]}));\n                  _observers[key].apply(this, [this.props[key], prevProps[key]]);\n                }\n              } else if (this.props[key] !== prevProps[key]) {\n                this.data[key] = this.props[key];\n                this.setData(this.data);\n              }\n            }\n          },",</span>lifeCircle=<span class="cstat-no" title="statement not covered" >[didMount,didUnmount,didUpdate].join(""),</span>observers=<span class="cstat-no" title="statement not covered" >uneval(observerMap).replace(/^\(|\)$/g,"").replace(/observer\(/g,"function(").replace(/\(\) =&gt; {/g,"function() {"),</span>newProps=<span class="cstat-no" title="statement not covered" >props.replace(str,uneval(propMap).replace(/^\(|\)$/g,""));<span class="cstat-no" title="statement not covered" ></span>return match.replace("Component({",`let _observers = ${observers};\r\nComponent({\r\n${lifeCircle}`).replace(props,newProps)}</span>).replace(/methods:[\s\n]*{[\s\S]*/g,e=&gt;e.replace(/on\w+\((\w+)\)\s*{/g,<span class="fstat-no" title="function not covered" >(e</span>,t)=&gt;<span class="cstat-no" title="statement not covered" >[e,`if (${t} &amp;&amp; ${t}.target &amp;&amp; ${t}.target.targetDataset) {\n              ${t}.target.dataset = ${t}.target.targetDataset;\n            }`].join("\r\n"))</span>)}module.exports=convert;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Thu Jan 02 2020 19:52:39 GMT+0800 (GMT+08:00)
</div>
</div>
<script src="../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../sorter.js"></script>
<script src="../../../../block-navigation.js"></script>
</body>
</html>
